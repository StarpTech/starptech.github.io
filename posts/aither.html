<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="dns-prefetch" href="//starptech.de"/><meta name="google" value="notranslate"/><meta name="referrer" content="strict-origin"/><meta name="description" content="Hi, my name is Dustin and I’m Fullstack Software Engineer from Germany"/><meta property="og:site_name" content="Dustin Deus"/><meta property="og:description" content="Hi, my name is Dustin and I’m Fullstack Software Engineer from Germany"/><meta property="og:type" content="website"/><meta name="generator" content="unix.bio"/><meta name="twitter:card" content="summary_large_image"/><meta name="author" content="Dustin Deus"/><meta name="twitter:creator" content="@dustindeus"/><meta property="og:title" content="Dustin Deus"/><meta property="og:url" content="starptech.de"/><meta property="og:image" content="https://starptech.de/assets/og-main.png"/><meta property="twitter:image" content="https://starptech.de/assets/og-main.png"/><meta itemProp="image" property="og:image" content="https://starptech.de/assets/og-main.png"/><meta name="viewport" content="initial-scale=1, maximum-scale=5, minimum-scale=1, viewport-fit=cover"/><title>An example microservice system using Hemera and best of today - Dustin Deus</title><meta property="og:title" content="An example microservice system using Hemera and best of today"/><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/CTF-Rq0Je7qo5FPRdYUF9/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/CTF-Rq0Je7qo5FPRdYUF9/pages/posts/aither.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5a5b5bf60b9fb373eea3.js" as="script"/><link rel="preload" href="/_next/static/chunks/593d3ac285c101c16752fed5719f2cc4645265c4.a1efe52ece78426e3f58.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-17b1f16568b60b0d7900.js" as="script"/><link rel="preload" href="/_next/static/chunks/0a0c070e0da3636e9ed6c243fe5a38e10df293c9.0e8dfb30dc2de074d183.js" as="script"/><style id="__jsx-1676753315">.tag{color:#666;}.punctuation{color:#888;}.attr-name{color:#444;}.attr-value{color:#888;}.language-javascript{color:#888;}span.class-name{color:#f5a623;}span.maybe-class-name{color:#f81ce5;}span.token.string{color:#666;}span.token.comment{color:#999;}span.token.parameter{color:#7928ca;}span.token.property-access{color:#f49b0b;}span.keyword{color:#0070f3;}span.token.boolean{color:#0366d6;}span.plain-text{color:#999;}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaXNtLWJhc2VsaW5lLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFXeUIsQUFHOEMsQUFJQSxBQUlBLEFBSUEsQUFJQSxBQUlBLEFBSUEsQUFJQSxBQUlBLEFBSUEsQUFJQyxBQUlBLEFBSUEsQUFJQSxtQ0FuRHRDLEFBSUEsQUFJQSxBQUlBLEFBSUEsQUFJQSxBQUlBLEFBSUEsQUFJQSxBQUlBLENBSUEsQUFJQSxBQUlBLEFBSUEiLCJmaWxlIjoicHJpc20tYmFzZWxpbmUudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgdXNlVGhlbWUgfSBmcm9tICdAemVpdC11aS9yZWFjdCdcbmltcG9ydCBmbHVzaCBmcm9tICdzdHlsZWQtanN4L3NlcnZlcidcbmltcG9ydCBmbHVzaFRvUmVhY3QgZnJvbSAnc3R5bGVkLWpzeC9zZXJ2ZXInXG5cbmNvbnN0IFByaXNtQmFzZWxpbmU6IFJlYWN0LkZDPFJlYWN0LlByb3BzV2l0aENoaWxkcmVuPHt9Pj4gPSAoeyBjaGlsZHJlbiB9KSA9PiB7XG4gIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKVxuXG4gIHJldHVybiAoXG4gICAgPD5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICAgIDxzdHlsZSBnbG9iYWwganN4PntgXG4gICAgICAgIC50YWcge1xuICAgICAgICAgIGNvbG9yOiAke3RoZW1lLnBhbGV0dGUuYWNjZW50c181fTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5wdW5jdHVhdGlvbiB7XG4gICAgICAgICAgY29sb3I6ICR7dGhlbWUucGFsZXR0ZS5hY2NlbnRzXzR9O1xuICAgICAgICB9XG5cbiAgICAgICAgLmF0dHItbmFtZSB7XG4gICAgICAgICAgY29sb3I6ICR7dGhlbWUucGFsZXR0ZS5hY2NlbnRzXzZ9O1xuICAgICAgICB9XG5cbiAgICAgICAgLmF0dHItdmFsdWUge1xuICAgICAgICAgIGNvbG9yOiAke3RoZW1lLnBhbGV0dGUuYWNjZW50c180fTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5sYW5ndWFnZS1qYXZhc2NyaXB0IHtcbiAgICAgICAgICBjb2xvcjogJHt0aGVtZS5wYWxldHRlLmFjY2VudHNfNH07XG4gICAgICAgIH1cblxuICAgICAgICBzcGFuLmNsYXNzLW5hbWUge1xuICAgICAgICAgIGNvbG9yOiAke3RoZW1lLnBhbGV0dGUud2FybmluZ307XG4gICAgICAgIH1cblxuICAgICAgICBzcGFuLm1heWJlLWNsYXNzLW5hbWUge1xuICAgICAgICAgIGNvbG9yOiAke3RoZW1lLnBhbGV0dGUucHVycGxlfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNwYW4udG9rZW4uc3RyaW5nIHtcbiAgICAgICAgICBjb2xvcjogJHt0aGVtZS5wYWxldHRlLmFjY2VudHNfNX07XG4gICAgICAgIH1cblxuICAgICAgICBzcGFuLnRva2VuLmNvbW1lbnQge1xuICAgICAgICAgIGNvbG9yOiAke3RoZW1lLnBhbGV0dGUuYWNjZW50c18zfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNwYW4udG9rZW4ucGFyYW1ldGVyIHtcbiAgICAgICAgICBjb2xvcjogJHt0aGVtZS5wYWxldHRlLnZpb2xldH07XG4gICAgICAgIH1cblxuICAgICAgICBzcGFuLnRva2VuLnByb3BlcnR5LWFjY2VzcyB7XG4gICAgICAgICAgY29sb3I6ICR7dGhlbWUucGFsZXR0ZS53YXJuaW5nRGFya307XG4gICAgICAgIH1cblxuICAgICAgICBzcGFuLmtleXdvcmQge1xuICAgICAgICAgIGNvbG9yOiAke3RoZW1lLnBhbGV0dGUuc3VjY2Vzc307XG4gICAgICAgIH1cblxuICAgICAgICBzcGFuLnRva2VuLmJvb2xlYW4ge1xuICAgICAgICAgIGNvbG9yOiAke3RoZW1lLnBhbGV0dGUuc3VjY2Vzc0Rhcmt9O1xuICAgICAgICB9XG5cbiAgICAgICAgc3Bhbi5wbGFpbi10ZXh0IHtcbiAgICAgICAgICBjb2xvcjogJHt0aGVtZS5wYWxldHRlLmFjY2VudHNfM307XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8Lz5cbiAgKVxufVxuXG50eXBlIE1lbW9QcmlzbUJhc2VsaW5lQ29tcG9uZW50PFAgPSB7fT4gPSBSZWFjdC5OYW1lZEV4b3RpY0NvbXBvbmVudDxQPiAmIHtcbiAgZmx1c2g6IHR5cGVvZiBmbHVzaFRvUmVhY3Rcbn1cblxuY29uc3QgTWVtb1ByaXNtQmFzZWxpbmUgPSBSZWFjdC5tZW1vKFByaXNtQmFzZWxpbmUpIGFzIE1lbW9QcmlzbUJhc2VsaW5lQ29tcG9uZW50PFxuICBSZWFjdC5Qcm9wc1dpdGhDaGlsZHJlbjx7fT5cbj5cbk1lbW9QcmlzbUJhc2VsaW5lLmZsdXNoID0gZmx1c2hcblxuZXhwb3J0IGRlZmF1bHQgTWVtb1ByaXNtQmFzZWxpbmVcbiJdfQ== */
/*@ sourceURL=prism-baseline.tsx */</style><style id="__jsx-2852680512">.article-content.jsx-2852680512{opacity:0;display:none;}</style><style id="__jsx-3922089209">@media only screen and (max-width:767px){html{font-size:15px;}}</style><style id="__jsx-3096432397">html,body{background-color:#fff;color:#000;}html{font-size:16px;--zeit-icons-background:#fff;}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.5;margin:0;padding:0;min-height:100%;position:relative;overflow-x:hidden;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;}#__next{overflow-x:hidden;}*,*:before,*:after{box-sizing:inherit;text-rendering:geometricPrecision;-webkit-tap-highlight-color:transparent;}p,small{font-weight:400;color:inherit;-webkit-letter-spacing:-0.005625rem;-moz-letter-spacing:-0.005625rem;-ms-letter-spacing:-0.005625rem;letter-spacing:-0.005625rem;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;}p{margin:1rem 0;font-size:1em;line-height:1.625em;}small{margin:0;line-height:1.5;font-size:0.875rem;}b{font-weight:600;}span{font-size:inherit;color:inherit;font-weight:inherit;}img{max-width:100%;}a{cursor:pointer;font-size:inherit;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-box-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#0070f3;-webkit-text-decoration:none;text-decoration:none;}a:hover{-webkit-text-decoration:none;text-decoration:none;}ul,ol{padding:0;list-style-type:none;margin:8pt 8pt 8pt 16pt;color:#000;}ol{list-style-type:decimal;}li{margin-bottom:0.625rem;font-size:1em;line-height:1.625em;}ul li:before{content:'–';display:inline-block;color:#888;position:absolute;margin-left:-0.9375rem;}h1,h2,h3,h4,h5,h6{color:inherit;margin:0 0 0.625rem 0;}h1{font-size:3rem;-webkit-letter-spacing:-0.066875rem;-moz-letter-spacing:-0.066875rem;-ms-letter-spacing:-0.066875rem;letter-spacing:-0.066875rem;line-height:1.5;font-weight:700;}h2{font-size:2.25rem;-webkit-letter-spacing:-0.020625rem;-moz-letter-spacing:-0.020625rem;-ms-letter-spacing:-0.020625rem;letter-spacing:-0.020625rem;font-weight:600;}h3{font-size:1.5rem;-webkit-letter-spacing:-0.029375rem;-moz-letter-spacing:-0.029375rem;-ms-letter-spacing:-0.029375rem;letter-spacing:-0.029375rem;font-weight:600;}h4{font-size:1.25rem;-webkit-letter-spacing:-0.020625rem;-moz-letter-spacing:-0.020625rem;-ms-letter-spacing:-0.020625rem;letter-spacing:-0.020625rem;font-weight:600;}h5{font-size:1rem;-webkit-letter-spacing:-0.01125rem;-moz-letter-spacing:-0.01125rem;-ms-letter-spacing:-0.01125rem;letter-spacing:-0.01125rem;font-weight:600;}h6{font-size:0.875rem;-webkit-letter-spacing:-0.005625rem;-moz-letter-spacing:-0.005625rem;-ms-letter-spacing:-0.005625rem;letter-spacing:-0.005625rem;font-weight:600;}button,input,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit;color:inherit;margin:0;}button:focus,input:focus,select:focus,textarea:focus{outline:none;}code{color:#f81ce5;font-family:Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace;font-size:0.9em;white-space:pre-wrap;}code:before,code:after{content:'\`';}pre{border:1px solid #eaeaea;border-radius:5px;padding:calc(16pt * 0.75) 16pt;margin:16pt 0;font-family:Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace;white-space:pre;overflow:auto;line-height:1.5;text-align:left;font-size:0.875rem;-webkit-overflow-scrolling:touch;}pre code{color:#000;font-size:0.75rem;line-height:1.25rem;white-space:pre;}pre code:before,pre code:after{display:none;}pre p{margin:0;}pre::-webkit-scrollbar{display:none;width:0;height:0;background:transparent;}hr{border-color:#eaeaea;}details{background-color:#fafafa;border:none;}details:focus,details:hover,details:active{outline:none;}summary{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;list-style:none;outline:none;}summary::-webkit-details-marker,summary::before{display:none;}summary::-moz-list-bullet{font-size:0;}summary:focus,summary:hover,summary:active{outline:none;list-style:none;}blockquote{padding:calc(0.667 * 16pt) 16pt;color:#666;background-color:#fafafa;border-radius:5px;margin:1.5rem 0;border:1px solid #eaeaea;}blockquote *:first-child{margin-top:0;}blockquote *:last-child{margin-bottom:0;}::selection{background-color:#79ffe1;color:#000;}</style></head><body><script>
            (function(){
              if (!window.localStorage) return;
              if (window.localStorage.getItem('theme') === 'dark') {
                document.documentElement.style.background = '#000';
                document.body.style.background = '#000';
              };
            })()
          </script><div id="__next"><div class="jsx-2852680512 article-content"><p><img src="https://github.com/hemerajs/aither/blob/master/logo.png?raw=true" alt="aither"/></p><h1>aither</h1><p>Aither shows an approach how to bootstrap a microservice system with <a href="https://github.com/hemerajs/hemera">Hemera</a> and docker.
You can scale your worker in seconds and because we use NATS as “nervous system&quot; for our distributed system we do not have to carry about service-discovery or load-balancing of hemera-services. We use traefik to load-balancing the api-gateway.</p><p>This configuration will setup:</p><ul><li><a href="https://github.com/hapijs/hapi">Hapi</a> http server which act as api-gataway to the Hemera services.</li><li><a href="https://github.com/hemerajs/aither/blob/master/worker/index.js">Microservice</a> example which is responsible to add two numbers.</li><li><a href="https://github.com/nats-io/gnatsd">NATS</a> server the underlying messaging system for Hemera.</li><li><a href="http://zipkin.io/">Zipkin</a> dashboard to monitoring your distributed system.</li><li><a href="https://github.com/devfacet/natsboard">Natsboard</a> dashboard to monitoring your NATS system in realtime.</li><li><a href="https://traefik.io/">Traefik</a> modern HTTP reverse proxy and load balancer made to deploy microservices with ease.</li></ul><h2>Architecture</h2><p><img src="https://github.com/hemerajs/aither/blob/master/aither-architecture.png?raw=true" alt="aither"/></p><h2>Running the system</h2><pre class="language-bash"><code class="language-bash">docker-compose up
</code></pre><h2>Scaling the system</h2><pre><code>docker-compose scale worker=5 api=2
</code></pre><h2>Run load test</h2><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g artillery
artillery run loadtest.yml
</code></pre><h2>Start a request against load balancer</h2><pre><code>http://localhost:8182/api/add?a=1&amp;b=10
</code></pre><h3>Traefik dashboard</h3><p><a href="http://localhost:8181/">http://localhost:8181/</a></p><h3>NATS dashboard</h3><p><a href="http://localhost:3000/">http://localhost:3000/</a></p><h3>NATS monitoring endpoint</h3><p><a href="http://localhost:8222/">http://localhost:8222/</a></p><h3>Zipkin dashboard</h3><p><a href="http://localhost:9411/">http://localhost:9411/</a></p><h3>Thank you</h3><p>thanks most of all to the community who create these awesome opensource software and thereby making it possible.</p></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/posts/aither","query":{},"buildId":"CTF-Rq0Je7qo5FPRdYUF9","runtimeConfig":{},"nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/runtime/polyfills-75a3e900f517af39100f.js"></script><script async="" data-next-page="/_app" src="/_next/static/CTF-Rq0Je7qo5FPRdYUF9/pages/_app.js"></script><script async="" data-next-page="/posts/aither" src="/_next/static/CTF-Rq0Je7qo5FPRdYUF9/pages/posts/aither.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="/_next/static/chunks/commons.5a5b5bf60b9fb373eea3.js" async=""></script><script src="/_next/static/chunks/593d3ac285c101c16752fed5719f2cc4645265c4.a1efe52ece78426e3f58.js" async=""></script><script src="/_next/static/runtime/main-17b1f16568b60b0d7900.js" async=""></script><script src="/_next/static/chunks/0a0c070e0da3636e9ed6c243fe5a38e10df293c9.0e8dfb30dc2de074d183.js" async=""></script><script src="/_next/static/CTF-Rq0Je7qo5FPRdYUF9/_buildManifest.js" async=""></script><script src="/_next/static/CTF-Rq0Je7qo5FPRdYUF9/_ssgManifest.js" async=""></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-115030952-1"></script><script async="">
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'UA-115030952-1');
              </script></body></html>